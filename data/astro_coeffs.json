{
  "description": "Nodal correction coefficients for tidal constituents. Based on pyTMD implementation which follows Schureman (1958) and Ray (1999).",
  "version": "1.0",
  "date_created": "2025-01-XX",
  "units": {
    "N": "radians (mean longitude of ascending lunar node)",
    "f": "dimensionless (amplitude modulation factor)",
    "u": "radians (phase correction angle)",
    "note": "To use these coefficients: (1) Calculate N in radians from time, (2) Compute term1 and term2, (3) f = sqrt(term1^2 + term2^2), (4) u = atan2(term1, term2)"
  },
  "coeffs": [
    {
      "name": "M2",
      "description": "Principal lunar semi-diurnal constituent",
      "f0": 1.0,
      "u0": 0.0,
      "v0": 0.0,
      "f_cos": {},
      "f_sin": {},
      "u_cos": {},
      "u_sin": {},
      "_nonlinear": {
        "method": "sqrt_atan2",
        "term1_sin": {
          "1": -0.03731,
          "2": 0.00052
        },
        "term2_const": 1.0,
        "term2_cos": {
          "1": -0.03731,
          "2": 0.00052
        },
        "formula": "term1 = -0.03731*sin(N) + 0.00052*sin(2*N); term2 = 1.0 - 0.03731*cos(N) + 0.00052*cos(2*N); f = sqrt(term1^2 + term2^2); u = atan2(term1, term2)"
      },
      "source": "pyTMD/arguments.py (OTIS model), Schureman (1958) Table 14",
      "validation": {
        "N_0deg": {
          "f": 0.963,
          "u_deg": 0.0
        },
        "N_180deg": {
          "f": 1.038,
          "u_deg": 0.0
        }
      }
    },
    {
      "name": "S2",
      "description": "Principal solar semi-diurnal constituent",
      "f0": 1.0,
      "u0": 0.0,
      "v0": 0.0,
      "f_cos": {},
      "f_sin": {},
      "u_cos": {},
      "u_sin": {},
      "_nonlinear": {
        "method": "sqrt_atan2",
        "term1_sin": {
          "1": 0.00225
        },
        "term2_const": 1.0,
        "term2_cos": {
          "1": 0.00225
        },
        "formula": "term1 = 0.00225*sin(N); term2 = 1.0 + 0.00225*cos(N); f = sqrt(term1^2 + term2^2); u = atan2(term1, term2)"
      },
      "source": "pyTMD/arguments.py (OTIS model), Schureman (1958)",
      "notes": "Solar constituent; nodal correction is small (empirical ~0.225%)"
    },
    {
      "name": "N2",
      "description": "Lunar elliptical semi-diurnal constituent (larger lunar elliptic)",
      "f0": 1.0,
      "u0": 0.0,
      "v0": 0.0,
      "f_cos": {},
      "f_sin": {},
      "u_cos": {},
      "u_sin": {},
      "_nonlinear": {
        "method": "sqrt_atan2",
        "term1_sin": {
          "1": -0.03731,
          "2": 0.00052
        },
        "term2_const": 1.0,
        "term2_cos": {
          "1": -0.03731,
          "2": 0.00052
        },
        "formula": "Same as M2"
      },
      "source": "pyTMD/arguments.py (OTIS model), Schureman (1958)",
      "notes": "N2 is a satellite of M2 and uses the same nodal corrections"
    },
    {
      "name": "K2",
      "description": "Lunisolar semi-diurnal constituent",
      "f0": 1.0,
      "u0": 0.0,
      "v0": 0.0,
      "f_cos": {},
      "f_sin": {},
      "u_cos": {},
      "u_sin": {},
      "_nonlinear": {
        "method": "sqrt_atan2",
        "term1_sin": {
          "1": -0.3108,
          "2": -0.0324
        },
        "term2_const": 1.0,
        "term2_cos": {
          "1": 0.2852,
          "2": 0.0324
        },
        "formula": "term1 = -0.3108*sin(N) - 0.0324*sin(2*N); term2 = 1.0 + 0.2852*cos(N) + 0.0324*cos(2*N); f = sqrt(term1^2 + term2^2); u = atan2(term1, term2)"
      },
      "source": "pyTMD/arguments.py (OTIS model), Schureman (1958) Table 14",
      "notes": "Lunisolar constituent; large nodal corrections (up to 30%)"
    },
    {
      "name": "K1",
      "description": "Lunisolar diurnal constituent",
      "f0": 1.0,
      "u0": 0.0,
      "v0": 0.0,
      "f_cos": {},
      "f_sin": {},
      "u_cos": {},
      "u_sin": {},
      "_nonlinear": {
        "method": "sqrt_atan2",
        "term1_sin": {
          "1": -0.1554,
          "2": 0.0029
        },
        "term2_const": 1.0,
        "term2_cos": {
          "1": 0.1158,
          "2": -0.0029
        },
        "formula": "term1 = -0.1554*sin(N) + 0.0029*sin(2*N); term2 = 1.0 + 0.1158*cos(N) - 0.0029*cos(2*N); f = sqrt(term1^2 + term2^2); u = atan2(term1, term2)"
      },
      "source": "pyTMD/arguments.py (OTIS model), Schureman (1958) Table 14",
      "validation": {
        "N_0deg": {
          "f": 0.885,
          "u_deg": 0.0
        },
        "N_180deg": {
          "f": 1.115,
          "u_deg": 0.0
        }
      },
      "notes": "Modulation coefficient k = 0.115 (23% variation)"
    },
    {
      "name": "O1",
      "description": "Principal lunar diurnal constituent",
      "f0": 1.0,
      "u0": 0.0,
      "v0": 0.0,
      "f_cos": {},
      "f_sin": {},
      "u_cos": {},
      "u_sin": {},
      "_nonlinear": {
        "method": "sqrt_atan2",
        "term1_sin": {
          "1": 0.189,
          "2": -0.0058
        },
        "term2_const": 1.0,
        "term2_cos": {
          "1": 0.189,
          "2": -0.0058
        },
        "formula": "term1 = 0.189*sin(N) - 0.0058*sin(2*N); term2 = 1.0 + 0.189*cos(N) - 0.0058*cos(2*N); f = sqrt(term1^2 + term2^2); u = atan2(term1, term2)"
      },
      "source": "pyTMD/arguments.py (OTIS model), Schureman (1958) Table 14",
      "validation": {
        "N_0deg": {
          "f": 1.189,
          "u_deg": 0.0
        },
        "N_180deg": {
          "f": 0.811,
          "u_deg": 0.0
        }
      },
      "notes": "Modulation coefficient k = 0.187 (largest variation, 37%)"
    },
    {
      "name": "P1",
      "description": "Principal solar diurnal constituent",
      "f0": 1.0,
      "u0": 0.0,
      "v0": 0.0,
      "f_cos": {},
      "f_sin": {},
      "u_cos": {},
      "u_sin": {},
      "_nonlinear": {
        "method": "sqrt_atan2",
        "term1_sin": {
          "1": -0.0112
        },
        "term2_const": 1.0,
        "term2_cos": {
          "1": -0.0112
        },
        "formula": "term1 = -0.0112*sin(N); term2 = 1.0 - 0.0112*cos(N); f = sqrt(term1^2 + term2^2); u = atan2(term1, term2)"
      },
      "source": "pyTMD/arguments.py (OTIS model), Schureman (1958)",
      "notes": "Solar constituent; small variation (0.988-1.014, ~1%)"
    },
    {
      "name": "Q1",
      "description": "Lunar elliptical diurnal constituent (larger lunar elliptic)",
      "f0": 1.0,
      "u0": 0.0,
      "v0": 0.0,
      "f_cos": {},
      "f_sin": {},
      "u_cos": {},
      "u_sin": {},
      "_nonlinear": {
        "method": "sqrt_atan2",
        "term1_sin": {
          "1": 0.1886
        },
        "term2_const": 1.0,
        "term2_cos": {
          "1": 0.1886
        },
        "formula": "term1 = 0.1886*sin(N); term2 = 1.0 + 0.1886*cos(N); f = sqrt(term1^2 + term2^2); u = atan2(term1, term2)"
      },
      "source": "pyTMD/arguments.py (OTIS model), Schureman (1958)",
      "notes": "Similar to O1; ~19% variation"
    },
    {
      "name": "M4",
      "description": "Shallow water overtide of M2",
      "f0": 1.0,
      "u0": 0.0,
      "v0": 0.0,
      "f_cos": {},
      "f_sin": {},
      "u_cos": {},
      "u_sin": {},
      "_derived": {
        "parent": "M2",
        "f_formula": "f_M4 = (f_M2)^2",
        "u_formula": "u_M4 = 2 * u_M2"
      },
      "source": "Theoretical derivation from parent constituent M2",
      "notes": "Shallow water constituent; f and u derived from M2"
    },
    {
      "name": "MS4",
      "description": "Shallow water compound tide of M2 and S2",
      "f0": 1.0,
      "u0": 0.0,
      "v0": 0.0,
      "f_cos": {},
      "f_sin": {},
      "u_cos": {},
      "u_sin": {},
      "_derived": {
        "parents": [
          "M2",
          "S2"
        ],
        "f_formula": "f_MS4 = f_M2 * f_S2",
        "u_formula": "u_MS4 = u_M2 + u_S2"
      },
      "source": "Theoretical derivation from parent constituents M2 and S2",
      "notes": "Shallow water constituent"
    },
    {
      "name": "MN4",
      "description": "Shallow water compound tide of M2 and N2",
      "f0": 1.0,
      "u0": 0.0,
      "v0": 0.0,
      "f_cos": {},
      "f_sin": {},
      "u_cos": {},
      "u_sin": {},
      "_derived": {
        "parents": [
          "M2",
          "N2"
        ],
        "f_formula": "f_MN4 = f_M2 * f_N2 = (f_M2)^2 (since N2 = M2)",
        "u_formula": "u_MN4 = u_M2 + u_N2 = 2 * u_M2"
      },
      "source": "Theoretical derivation from parent constituents M2 and N2",
      "notes": "Shallow water constituent; N2 uses same corrections as M2"
    },
    {
      "name": "M6",
      "description": "Shallow water overtide of M2",
      "f0": 1.0,
      "u0": 0.0,
      "v0": 0.0,
      "f_cos": {},
      "f_sin": {},
      "u_cos": {},
      "u_sin": {},
      "_derived": {
        "parent": "M2",
        "f_formula": "f_M6 = (f_M2)^3",
        "u_formula": "u_M6 = 3 * u_M2"
      },
      "source": "Theoretical derivation from parent constituent M2",
      "notes": "Shallow water constituent"
    },
    {
      "name": "S4",
      "description": "Shallow water overtide of S2",
      "f0": 1.0,
      "u0": 0.0,
      "v0": 0.0,
      "f_cos": {},
      "f_sin": {},
      "u_cos": {},
      "u_sin": {},
      "_derived": {
        "parent": "S2",
        "f_formula": "f_S4 = (f_S2)^2",
        "u_formula": "u_S4 = 2 * u_S2"
      },
      "source": "Theoretical derivation from parent constituent S2",
      "notes": "Shallow water constituent"
    }
  ],
  "sources": [
    {
      "name": "pyTMD (Python-based Tidal Prediction Software)",
      "url": "https://github.com/pyTMD/pyTMD",
      "detail": "pyTMD/arguments.py, nodal() function. Implementation based on ARGUMENTS.f by Richard Ray (1999)",
      "license": "MIT"
    },
    {
      "name": "Schureman 1958",
      "url": "https://tidesandcurrents.noaa.gov/publications/SpecialPubNo98.pdf",
      "detail": "Manual of Harmonic Analysis and Prediction of Tides. US Coast and Geodetic Survey Special Publication 98. Table 14 (pp. 190-195), Sections 186-196 on nodal corrections"
    },
    {
      "name": "Cartwright & Tayler 1971",
      "url": "https://doi.org/10.1111/j.1365-246X.1971.tb02333.x",
      "detail": "New Computations of the Tide-generating Potential. Geophysical Journal of the Royal Astronomical Society, Vol. 23, pp. 45-74"
    },
    {
      "name": "Cartwright & Edden 1973",
      "url": "https://doi.org/10.1111/j.1365-246X.1973.tb03420.x",
      "detail": "Corrected Tables of Tidal Harmonics. Geophysical Journal International, Vol. 33, pp. 253-264. Corrections to Cartwright & Tayler (1971)"
    },
    {
      "name": "DFO-MPO Canada Node Factor Table",
      "url": "https://www.dfo-mpo.gc.ca/science/data-donnees/tidal-marees/facteur-node-factor-eng.html",
      "detail": "Table of values for node factor f. Extends Schureman (1959) Table 14 beyond 1999"
    },
    {
      "name": "Ray 1999",
      "url": "N/A",
      "detail": "ARGUMENTS Fortran subroutine for tidal nodal corrections (March 1999). Implemented in pyTMD"
    }
  ],
  "implementation_notes": {
    "N_calculation": "N (mean longitude of ascending lunar node) should be calculated from time using: T = (MJD - 51544.5) / 36525.0; N = 125.04452 - 1934.136261*T + 0.0020708*T^2 + T^3/450000.0; N = N % 360.0; N_rad = N * (pi/180)",
    "unit_conversion": "All coefficients expect N in radians. Output u is in radians; convert to degrees if needed by multiplying by 180/pi",
    "phase_convention": "For use with phase_convention=vu, apply: h(t) = Σ f_k * A_k * cos(ω_k*t - φ_k + (V_k + u_k)). V_k (equilibrium argument) is currently 0 in simplified implementation",
    "accuracy": "The nonlinear formulas (sqrt/atan2) are accurate to better than 0.01% for f and 0.001° for u. Linear approximations (using f_cos, f_sin, u_cos, u_sin) may have errors up to 0.2% for f and 0.05° for u",
    "shallow_water": "Shallow water constituents (M4, MS4, MN4, M6, S4) derive their nodal corrections from parent constituents. Do not use _nonlinear fields for these; instead compute from parents using _derived formulas"
  },
  "validation_data": {
    "description": "Sample validation points from DFO-MPO table",
    "date": "2006-07-01 (N ≈ 0°)",
    "M2": {
      "f": 0.962,
      "expected_range": "0.962-0.963"
    },
    "K1": {
      "f": 0.885,
      "expected_range": "0.885-0.886"
    },
    "O1": {
      "f": 1.189,
      "expected_range": "1.189-1.190"
    }
  },
  "notes": "This JSON provides nodal correction coefficients for major tidal constituents (M2, S2, N2, K2, K1, O1, P1, Q1) and shallow water constituents (M4, MS4, MN4, M6, S4). The coefficients are in the _nonlinear field using the sqrt/atan2 method, which is the most accurate. For implementation, calculate N from time, then compute term1 and term2 from the coefficients, then f = sqrt(term1^2 + term2^2) and u = atan2(term1, term2). The 18.6-year nodal cycle is represented by the variation in these factors with N."
}
